---
title: 'Prueba extra 2021 '
author: 'NOMBRE: ¡ngela Vieyto'
date: "19/6/2021"
output:
  pdf_document: default
  html_document:
    df_print: paged
fig_caption: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'hbpt', out.extra = '', message = FALSE, warning = FALSE)
```


# Ejercicio 1 (80 puntos)

## Explicativo sobre los datos para el Ejercicio 1

Los datos que vamos a utilizar son del cat√°logo de datos abertos (https://catalogodatos.gub.uy).
Especificamente utilizaremos los datos de la Encuesta de Conocimientos, Actitudes y Pr√°cticas de Ciudadan√≠a Digital en Uruguay realizada por AGESIC. En la carpeta Revisi√≥n de la semana 10 encontrar√°s dos archivos `basededatosobcuiucao2013.csv` que contiene los datos de la encuesta y el archivo `metadatoscap2013.csv` que contiene los metadatos de dicha encuesta (descripci√≥n de variables, codificaci√≥n, preguntas, etc ).

## (1 punto) *Pregunta 1* 

Leer los datos `basededatosobsciucap2013.csv` usando la funci√≥n `read_delim()`
Para que la vida te sonr√≠a para arrancar la prueba, te soplo la primer respuesta para leer los datos (solo ten√©s que cambiar DATOS ).  

```{r, echo=FALSE}
library(tidyverse)
library(readr)
library(here)
```

```{r, echo=TRUE, eval = FALSE}

datadigital <-  read_delim(file = "basededatosobsciucap2013.csv", delim = ";",
                          escape_double = FALSE, 
                          locale = locale(encoding = "IBM437"), trim_ws = TRUE)

```


## (2 puntos) *Pregunta 2*

Vamos a trabajar con un subconjunto de los datos. Gener√° un nuevo objeto llamado `digital_red` que contenga las variables desde `P1V15Departamento` hasta `P24V40` (en el archivo `metadatoscap2013.csv` pod√©s encontrar el nombre de todas las variables junto con su descripci√≥n). El conjunto de datos reducidos (`digital_red`) debe tener 1006 filas y 30 columnas.

De ahora en m√°s trabajaremos con el conjunto de datos reducidos `digital_red`.


```{r, eval = FALSE}
digital_red <- datadigital %>% select(P1V15Departamento:P24V40)
```



## (7 puntos) *Pregunta 3 *

Usando funciones del paquete `ggplot2`, hac√© un gr√°fico de barras que contenga la cantidad de personas que utiliz√≥ alguna vez internet (`P11V25Utiliz√≥vezinternet`). Cambi√° los ticks del eje `x`  donde dice 1 debe decir `Si` y donde dice `2` debe decir `No` y en el resto de los ticks nada. Para esta parte debes notar que la variable `P11V25Utiliz√≥vezinternet` es continua. Cambi√° la etiqueta del eje `y` a `Cantidad` y la del eje `x` a `Us√≥ internet`. 

El gr√°fico debe quedarte como sigue y en vez de "Gr√°fico a replicar" (`caption`) debes agregar un t√≠tulo que describa la figura y un comentario sobre la misma.

\begin{figure}[htbp]
\centering
\includegraphics[width=15cm, height =10cm]{pl1.png}
\caption{Gr√°fico a replicar}
\end{figure}

\newpage


```{r}
digital_red %>% 
  ggplot(aes(x = P11V25UtilizÛvezinternet)) +
  geom_bar() +
  scale_x_continuous(breaks = c(1,2), labels = c("SÌ", "No")) +
  labs(x = "UsÛ internet", y = "Cantidad")
```



## (7 puntos) *Pregunta 4*

Esta pregunta tiene tres partes:

1. Renombr√° la variable `P11V25Utiliz√≥vezinternet` como `usoint`
2. Transform√° la variable `usoint` en una variable de tipo factor
3. Recodific√° la variable `usoint` para que `1` sea `Si`, `2` sea `No` y `99` sea `NA`
4. Luego de todos los pasos anteriores repet√≠ el gr√°fico de la Pregunta 3

```{r}
digital_red %>% 
  mutate(usoint = factor(P11V25UtilizÛvezinternet,
                         labels = c("1" = "Si", "2" = "No"))) %>% 
  ggplot(aes(x = usoint)) +
  geom_bar() +
  labs(x = "UsÛ internet", y = "Cantidad")

```



## (7 puntos) *Pregunta 5*

Usando funciones de `dplyr` respond√©. ¬øQu√© proporci√≥n de personas  utiliz√≥ alguna vez internet?

```{r}

```



## (10 puntos) *Pregunta 6*

Usando funciones de `dplyr` respond√©. ¬øQu√© proporci√≥n de personas que utilizaron alguna vez internet son de Montevideo?

```{r}
digital_red %>% 
+     group_by(P1V15Departamento) %>%
+     summarise(total = n()) %>% 
+     filter(P1V15Departamento == 10) 
  
```


## (10 puntos) *Pregunta 7*
Utilizando `rename_with` de `dplyr`  cambi√°le en el nombre de todas las variables que contienen `P14V30Lugaresutiliz√≥internet_` por `lugar_int`, por ejemplo la variable que se llama `P14V30Lugaresutiliz√≥internet_M4` se debe llamar `lugar_int_M4` y de forma similar el resto. Pista us√° `gsub` 


## (12 puntos) *Pregunta 8*

Usando `ggplot2` realiza una visualizaci√≥n apropiada a tu elecci√≥n para ver la distribuci√≥n de las edades de las personas que nunca usaron internet seg√∫n sexo. Debes incluir etiquetas apropiadas para los ejes y t√≠tulo. Describe brevemente que ves en el gr√°fico y coment√° si hay o no diferencias en la edad entre hombres y mujeres.

A su vez usando funciones de `dplyr` respond√© ¬øCu√°l es el promedio de edad de las personas que nunca usaron internet para cada sexo? 

## (14 puntos) *Pregunta 9*

Usando `ggplot2` replic√° el siguiente gr√°fico para visualizar la distribuci√≥n de la variable `P8V22Hogarconexi√≥nainternet` por departamento. Inclu√≠ un t√≠tulo apropiado para el gr√°fico y un breve comentario de lo que se puede observar en el mismo. La codificaci√≥n de la variable `P1V15Departamento` est√° en los metadatos por simplicidad miralos en la siguiente tabla:

```{r,results="asis", echo=FALSE }
library(xtable)
options(xtable.comment = FALSE)
tbl<- tibble(C√≥digo = 1:19, Departamento = c("Artigas", "Canelones","Cerro Largo",
"Colonia","Durazno","Flores", "Florida", "Lavalleja","Maldonado","Montevideo","Paysand√∫","R√≠o Negro",
"Rivera","Rocha","Salto","San Jos√©","Soriano","Tacuaremb√≥","Treinta y Tres"))
tbl %>% xtable() %>% print(include.rownames = FALSE)

```

\begin{figure}[!h]
\centering
\includegraphics[width=15cm, height =10cm]{pl2.png}
\caption{Gr√°fico a replicar}
\end{figure}

\newpage

## (10 puntos) *Pregunta 10*

Queremos saber con que frecuencia las personas usan internet para trabajar. Para esto:

- Se utiliz√≥ la variable `P22V38Trabajar` y dado que la misma contiene muchos valores `#¬°NULO!` y `99`, se filtraron  los valores diferentes a √©stos.
- Posteriormente se realiz√≥ un gr√°fico de barras de `P22V38Trabajar` (filtrada) como el que aparece a continuaci√≥n.

\begin{figure}[!h]
\centering
\includegraphics[width=15cm, height =10cm]{pl3.png}
\caption{Gr√°fico de barras con la cantidad de personas seg√∫n frecuencia de uso de internet para trabajar. }
\end{figure}

\newpage 

En base a esta figura respond√© las siguientes preguntas:

1. ¬øQu√© argumento del gr√°fico de barras, en `aes()`, me permite colorear las barras como se ven en la Figura 3? (Pista, aqu√≠ los colores usados son por defecto). 

2. Inclu√≠ la linea de c√≥digo que corresponde a definir el tama√±o del texto del eje x en 8.

3. Inclu√≠ la linea de c√≥digo que define las etiquetas que se muestran en el eje x (Pista, observ√° que usando `\n` se genera un salto de rengl√≥n para que las etiquetas queden como se ve en el gr√°fico). 

## Ejercicio 2 (20 Puntos)


1. Indique cu√°l de las siguientes opciones NO corresponde a partes de un gr√°fico estad√≠stico.
 
Seleccione una:

a) Datos, mapeo est√©tico y sistema de coordenadas

b) Datos, mapeo est√©tico y escalas

c) Datos, mapeo est√©tico y modelo estad√≠stico

d) Datos, mapeo est√©tico y temas 


La opciÛn C, ya que el modelo estadÌstico no es una parte de los gr·ficos estadÌsticos.


2. Indica cu√°l de las opciones describe mejor lo que hace la funci√≥n
```{r,eval=FALSE}
func1 <-function(a){
for(i in 1:a){
      b <- i^2
print(b)}
}
```
a. Calcula un n√∫mero al cuadrado
b. Calcula una sequencia de n√∫meros al cuadrado
c. Calcula el producto de a por 2
d. Calcula una sequencia de n√∫meros al cuadrado para valores positivos de a

OpciÛn A: calcula el valor al cuadrado de `a`. 


3. Hac√© una funci√≥n  llamada `simulaplot` que tenga como argumentos `n` tama√±o de muestra, `sigma` el desvio y `forma`. Esta funci√≥n simula datos  para distintos tama√±os de muestra con distinta media y desvio de una distribuci√≥n normal usando `rnorm` y simula la misma cantidad de observaciones n de una distribuci√≥n con `rgamma` cambiando el par√°metro de forma. Como resultado de esta funci√≥n se hace un diagrama de dispersi√≥n con x los datos simulados normales y en y los datos gamma.
A su vez si el argumento es sigma es negativo la funci√≥n no debe ser evaluada y debe imprimir el mensaje "sigma debe ser positivo".

```{r}
simulaplot <-function(n, sigma, forma){
  
  if (sigma < 0) {
    print("Sigma debe ser positivo.")
  } else {
    datos_norm <- rnorm(n, sd = sigma)
    datos_gamma <- rgamma(n, shape = forma)
    datos <- data.frame(datos_norm, datos_gamma)
  
    ggplot(datos, aes(x = datos_norm, y = datos_gamma)) +
    geom_point()
  }
}

simulaplot(20,1,4)
```
